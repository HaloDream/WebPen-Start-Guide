Web 渗透测试入门手册
===
第一章：Web 架构基础与安全原理
1.1 网络协议栈深度安全
1.1.1 HTTP/1.x 状态机与报文结构 [初级]（包含 4 个知识点）
1.1.1.1 HTTP 请求报文标准格式与安全字段解析

1.1.1.2 HTTP 响应报文标准格式与信息泄露点分析

1.1.1.3 请求方法（GET, POST, PUT, DELETE, TRACE, CONNECT）的安全属性与攻击面

1.1.1.4 HTTP 无状态与会话管理机制的安全关联

1.1.2 HTTPS 握手与证书校验机制 [初级]（包含 4 个知识点）
1.1.2.1 SSL/TLS 握手协议（RSA/ECDHE）全流程拆解与密钥协商原理

1.1.2.2 数字证书结构、信任链验证与CA体系漏洞（如错误签发）

1.1.2.3 中间人攻击（MITM）原理、工具（Burp, mitmproxy）及防御（HSTS）

1.1.2.4 弱加密套件识别、协议降级攻击（如 POODLE）与安全配置

1.1.3 HTTP/2 & HTTP/3 (QUIC) 协议安全 [进阶]（包含 3 个知识点）
1.1.3.1 HTTP/2 多路复用、头部压缩（HPACK）与流管理攻击面

1.1.3.2 HPACK 压缩侧信道攻击（如 CRIME 变种）原理

1.1.3.3 QUIC 协议特性、0-RTT 安全风险及防火墙绕过潜力

1.1.4 WebSocket 全双工通信安全 [进阶]（包含 3 个知识点）
1.1.4.1 WebSocket 握手协议安全与跨域劫持（CSWSH）漏洞

1.1.4.2 WebSocket 消息流模糊测试（Fuzzing）与输入验证漏洞

1.1.4.3 基于 WebSocket 的实时通信应用渗透测试案例

1.2 浏览器安全防御体系
1.2.1 同源策略 (SOP) 与跨域资源共享 (CORS) [初级]（包含 3 个知识点）
1.2.1.1 同源策略限制范围（DOM、Cookie、Ajax）与跨域嵌入例外

1.2.1.2 CORS 预检请求（Preflight）机制与复杂请求处理

1.2.1.3 CORS 错误配置（如 Access-Control-Allow-Origin: * 且带凭证）漏洞利用

1.2.2 Cookie 安全属性深度解析 [初级]（包含 4 个知识点）
1.2.2.1 Cookie 作用域（Domain/Path）与生命周期管理安全

1.2.2.2 HttpOnly 属性对 XSS 窃取的防御原理与局限性

1.2.2.3 Secure 属性在混合内容（HTTP/HTTPS）环境下的风险

1.2.2.4 SameSite 属性（Strict/Lax/None）对 CSRF 和跨站请求的防御机制

第二章：信息收集与攻击面管理 (ASM)
2.1 资产挖掘与网络空间测绘
2.1.1 子域名枚举与接管探测 [初级]（包含 3 个知识点）
2.1.1.1 被动子域名收集（搜索引擎、证书透明度、第三方服务）

2.1.1.2 主动子域名爆破（字典生成、DNS暴力破解、泛解析处理）

2.1.1.3 子域名接管漏洞（CNAME/A记录指向未占用服务）验证与利用

2.1.2 端口扫描与指纹识别 [初级]（包含 3 个知识点）
2.1.2.1 高级端口扫描技术（SYN/ACK/UDP、僵尸扫描、速率控制）

2.1.2.2 Web 服务指纹识别（响应头、文件哈希、默认内容、WAF识别）

2.1.2.3 CDN/WAF 识别与真实源 IP 探测技术（历史DNS、子域名、邮件服务）

2.1.3 目录与敏感文件扫描 [初级]（包含 3 个知识点）
2.1.3.1 常见敏感文件与目录字典构建方法论

2.1.3.2 扫描工具（Dirsearch, gobuster, ffuf）实战技巧与结果分析

2.1.3.3 智能去重与误报排除（基于响应长度、状态码、内容关键词）

第三章：输入验证与注入类漏洞
3.1 关系型与非关系型数据库注入
3.1.1 经典 SQL 注入 (SQLi) 实战 [初级]（包含 3 个知识点）
3.1.1.1 注入点识别、闭合方式判断与注释符使用

3.1.1.2 联合查询注入、报错注入、布尔/时间盲注的完整利用链

3.1.1.3 利用系统库（information_schema, sys）进行数据库结构探测与数据提取

3.1.2 SQL 注入高级绕过与带外利用 [进阶]（包含 3 个知识点）
3.1.2.1 编码与解析差异导致的注入（宽字节、二次注入）

3.1.2.2 无回显注入的带外（OOB）数据外带技术（DNSlog, HTTPlog）

3.1.2.3 WAF/IDS 绕过技巧（大小写、编码、等价函数、注释混淆、分块传输）

3.1.3 NoSQL 注入原理与利用 [进阶]（包含 3 个知识点）
3.1.3.1 MongoDB 操作符注入（$where, $ne, $regex）与布尔盲注

3.1.3.2 JSON 注入与逻辑运算符篡改（如 || "1"=="1"）

3.1.3.3 NoSQL 注入自动化检测工具与手动测试深度对比

3.2 逻辑解析类注入
3.2.1 XML 外部实体注入 (XXE) [进阶]（包含 4 个知识点）
3.2.1.1 DTD 内部/外部/参数实体声明语法与解析过程

3.2.1.2 利用 XXE 进行任意文件读取、SSRF 和内网端口扫描

3.2.1.3 盲 XXE 的带外（OOB）利用与参数实体攻击链构造

3.2.1.4 不同语言（Java/PHP/.NET）环境下 XXE 的防御与绕过

3.2.2 服务器端模板注入 (SSTI) [进阶]（包含 4 个知识点）
3.2.2.1 常见模板引擎（Jinja2, Twig, Freemarker, Velocity, Smarty）识别

3.2.2.2 注入上下文判断（纯文本输出 vs. 代码执行）与基础 Payload 构造

3.2.2.3 沙箱逃逸技术：通过内置对象/方法链实现远程代码执行（RCE）

3.2.2.4 针对不同语言环境的 SSTI 利用工具（如 Tplmap）与手动利用链编写

第四章：代码执行与文件处理安全
4.1 命令与代码执行 (RCE)
4.1.1 系统命令注入与无回显利用 [初级]（包含 3 个知识点）
4.1.1.1 跨平台命令拼接符（;, &, |, &&, ||）与通配符（*, ?）利用

4.1.1.2 无回显命令注入的检测（时间延迟、DNS/HTTP外带、反向Shell）

4.1.1.3 命令注入绕过技巧：空格替代、特殊字符转义、编码混淆

4.1.2 动态代码注入与反弹 Shell [初级]（包含 3 个知识点）
4.1.2.1 高危函数识别（eval(), exec(), system(), assert()）与利用

4.1.2.2 多语言（Bash, Python, PHP, Perl, PowerShell）反弹 Shell 构造

4.1.2.3 加密隧道与隐蔽通道建立（OpenSSL, SSH, ICMP, DNS）

4.2 文件上传与解析漏洞 [初级/进阶混合]
4.2.1 文件上传基础绕过与 Webshell 写入 [初级]（包含 4 个知识点）
4.2.1.1 客户端（JS）校验绕过、MIME 类型伪造与扩展名黑名单绕过

4.2.1.2 文件内容检测绕过（文件头、幻数、图像二次渲染）

4.2.1.3 路径遍历、文件名混淆（点号、空格、截断）与 .htaccess 利用

4.2.1.4 Webshell 特性分析、免杀技巧与内存马初步概念

4.2.2 文件解析与逻辑漏洞高级利用 [进阶]（包含 3 个知识点）
4.2.2.1 Web 容器解析漏洞（IIS 6.0 分号、Nginx %00、Apache 多后缀）

4.2.2.2 条件竞争（Race Condition）攻击：上传与校验/删除的时间差利用

4.2.2.3 云存储服务（AWS S3, Aliyun OSS）错误配置导致的数据泄露与篡改

第五章：访问控制与身份鉴权漏洞
5.1 身份认证失效
5.1.1 认证流程逻辑缺陷与 MFA 绕过 [初级]（包含 3 个知识点）
5.1.1.1 用户名枚举技术（响应时间、错误信息差异、响应码）

5.1.1.2 验证码逻辑漏洞（可重用、不刷新、可绕过、识别破解）

5.1.1.3 多因素认证（MFA）绕过（状态码操纵、SIM劫持、备用代码滥用）

5.1.2 现代鉴权安全 (JWT/OAuth) [进阶]（包含 4 个知识点）
5.1.2.1 JWT 结构解析、弱密钥爆破与“none”算法攻击

5.1.2.2 JWT 头部参数注入（kid, jku, x5u）攻击与密钥重定向

5.1.2.3 OAuth 2.0 授权码劫持、重定向URI未校验与隐式流程风险

5.1.2.4 OAuth state 参数缺失与 scope 权限提升攻击

第六章：业务逻辑漏洞深度剖析
6.1 通用业务逻辑缺陷 [初级/进阶混合]
6.1.1 订单与支付逻辑漏洞 [初级]（包含 4 个知识点）
6.1.1.1 客户端价格/数量篡改（参数污染）

6.1.1.2 优惠券逻辑缺陷（无限发放、重复使用、金额溢出）

6.1.1.3 支付状态异步通知校验绕过与“0元支付”

6.1.1.4 业务流程乱序（未支付发货、未验证重置密码）

6.1.2 竞争条件漏洞 [进阶]（包含 3 个知识点）
6.1.2.1 竞争条件原理与多线程/异步处理中的攻击窗口

6.1.2.2 经典案例：限量商品超卖、余额并发提现（薅羊毛）

6.1.2.3 竞争条件自动化探测（Turbo-Intruder）与利用脚本编写

6.1.3 权限与状态管控缺陷 [初级]（包含 3 个知识点）
6.1.3.1 水平越权（ID遍历、属性篡改）与垂直越权（功能未授权）

6.1.3.2 资源ID可预测性分析与遍历攻击防御

6.1.3.3 功能接口未授权访问（如管理API、内部接口暴露）

第七章：客户端安全与状态篡改
7.1 跨站脚本攻击 (XSS)
7.1.1 存储型与反射型 XSS 实战 [初级]（包含 3 个知识点）
7.1.1.1 输入点（Source）与输出点（Sink）的追踪与定位

7.1.1.2 XSS Payload 构造与常见过滤（黑名单、编码）绕过

7.1.1.3 盲 XSS (Blind XSS) 原理、利用场景与平台搭建

7.1.2 DOM-based XSS 深度审计 [进阶]（包含 3 个知识点）
7.1.2.1 危险 Sink 函数（innerHTML, document.write, eval）审计

7.1.2.2 现代前端框架（Vue/React/Angular）的 XSS 风险点与安全上下文

7.1.2.3 浏览器调试工具（DevTools）在动态 XSS 挖掘中的应用

7.1.3 基于 DOM 的客户端漏洞挖掘 [进阶]（包含 3 个知识点）
7.1.3.1 开放重定向漏洞的多种触发点（参数、Header）与钓鱼利用

7.1.3.2 客户端原型链污染原理、PoC 构造与影响（导致XSS/RCE）

7.1.3.3 postMessage 通信未验证消息源导致的跨域数据窃取与DOM操作

第八章：服务端组件与协议深度安全
8.1 序列化与反序列化漏洞
8.1.1 PHP 反序列化与 POP 链构造 [进阶]（包含 3 个知识点）
8.1.1.1 PHP 序列化字符串格式与魔术方法自动触发链

8.1.1.2 面向属性编程（POP）链手动构造方法论

8.1.1.3 利用 PHP 原生类（SoapClient, SimpleXMLElement）进行 SSRF/XXE

8.1.2 Java 反序列化与组件漏洞 [进阶]（包含 3 个知识点）
8.1.2.1 Java 对象序列化流特征与反序列化入口点寻找

8.1.2.2 CommonsCollections 等经典 Gadget 链分析与利用

8.1.2.3 Fastjson/Jackson 反序列化漏洞中的 JNDI 注入与高版本绕过

8.1.3 Python & .NET 反序列化漏洞浅析 [进阶]（包含 2 个知识点）
8.1.3.1 Python pickle 模块反序列化与 __reduce__ 利用

8.1.3.2 .NET ViewState 反序列化与 ObjectStateFormatter 攻击

第九章：API 安全与云原生渗透
9.1 现代 API 安全 (REST/GraphQL) [进阶]（包含 3 个知识点）
9.1.1 批量分配 (Mass Assignment) 漏洞原理、测试与修复

9.1.2 GraphQL 内省（Introspection）查询与接口信息泄露

9.1.3 GraphQL 查询复杂度攻击（嵌套深度、循环引用）与防护

第十章：渗透测试后期规范
10.1 后渗透基础与持久化 [进阶]（包含 3 个知识点）
10.1.1 内存马（Java Agent, Filter, Servlet）注入原理与无文件利用

10.1.2 内网穿透隧道技术（reGeorg, frp, ngrok）与流量伪装

10.1.3 隐蔽权限维持（计划任务、服务、注册表、启动项、隐藏文件）

10.2 报告编写与 CVSS 评分 [初级]（包含 3 个知识点）
10.2.1 渗透测试报告标准结构、漏洞复现步骤与证据固化

10.2.2 CVSS v3.1 评分标准详解与实战评分练习

10.2.3 针对业务场景的风险评级与修复方案建议撰写

第十一章：代码审计与漏洞研究进阶
11.1 白盒/灰盒审计方法论 [进阶]
11.1.1 审计环境搭建与核心思路 [进阶]（包含 3 个知识点）
11.1.1.1 源代码获取、构建、调试与依赖分析环境搭建

11.1.1.2 敏感函数/关键词追踪法（Source-to-Sink）

11.1.1.3 功能点审计法与攻击面建模

11.1.2 主流语言代码审计要点 [进阶]（包含 4 个知识点）
11.1.2.1 PHP 代码审计：危险函数、文件包含、反序列化、框架漏洞

11.1.2.2 Java 代码审计：框架配置、表达式注入、反序列化链、JNDI

11.1.2.3 Python 代码审计：反序列化、模板注入、命令执行、依赖安全

11.1.2.4 JavaScript/Node.js 审计：原型污染、命令执行、npm 包风险

11.2 漏洞挖掘与研究案例复盘 [进阶]
11.2.1 从补丁对比到漏洞挖掘 [进阶]（包含 2 个知识点）
11.2.1.1 安全补丁分析（Git diff, 官方通告）与漏洞点定位

11.2.1.2 基于补丁分析的漏洞原理推断与 POC 构造思路

11.2.2 真实世界 CVE 漏洞代码级复现 [进阶]（包含 2 个知识点）
11.2.2.1 选取典型 CVE（如框架 RCE），搭建漏洞环境与调试分析

11.2.2.2 完整复现漏洞触发路径、分析成因并编写利用 EXP